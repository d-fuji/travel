# 事前準備タスク管理機能 PRD (Product Requirements Document)

## 概要

旅行計画アプリに事前準備のタスク管理機能を追加し、旅行前の準備を効率的に管理・共有できるようにする。

## 目的

- 旅行前の準備タスクを体系的に管理する
- グループメンバー間でタスクを分担・共有する
- 準備の進捗を可視化し、漏れを防ぐ
- 旅行当日までに必要な準備を完了させる

## 対象ユーザー

- カップルや家族で旅行を計画するユーザー
- グループ旅行で準備を分担したいユーザー
- 旅行準備を計画的に進めたいユーザー

## 機能要件

### 1. タスク管理機能

#### 1.1 タスクの追加
- **入力項目**：
  - タスク名（必須）
  - カテゴリ（交通手配、宿泊手配、パスポート・ビザ、持ち物準備、予約・チケット、その他）
  - 担当者（デフォルト：作成者）
  - 期限（任意）
  - 優先度（高・中・低）
  - メモ（任意）
  - 完了状態（未完了・完了）

#### 1.2 タスクの編集・削除
- タスクの内容を後から編集可能
- 作成者と担当者のみ編集・削除可能（権限制御）
- 完了済みタスクの再開可能

#### 1.3 タスクの一覧表示
- 期限順・作成日順・優先度順でソート可能
- カテゴリでフィルタリング可能
- 担当者でフィルタリング可能
- 完了・未完了でフィルタリング可能

### 2. タスク分担機能

#### 2.1 担当者指定
- メンバーの中から担当者を選択
- 複数人での分担も可能
- 担当者変更時の通知

#### 2.2 進捗共有
- リアルタイムでタスクの完了状況を共有
- メンバー別の担当タスク数・完了率表示

### 3. カテゴリ別管理

#### 3.1 事前定義カテゴリ
- **交通手配**：航空券、新幹線、レンタカー等の予約
- **宿泊手配**：ホテル、旅館、民泊等の予約
- **パスポート・ビザ**：有効期限確認、申請手続き
- **持ち物準備**：衣類、薬、充電器等のパッキング
- **予約・チケット**：レストラン、観光施設等の事前予約
- **その他**：保険加入、現地通貨両替等

#### 3.2 カテゴリ別進捗
- カテゴリごとの完了率表示
- 重要度の高いカテゴリの優先表示

### 4. 期限管理・通知機能

#### 4.1 期限の可視化
- 期限が近いタスクのハイライト表示
- 期限超過タスクの警告表示
- 旅行開始日までのカウントダウン

#### 4.2 リマインダー機能
- 期限前の自動通知（1週間前、3日前、1日前）
- 未完了タスクの定期リマインダー

### 5. テンプレート機能

#### 5.1 事前定義テンプレート
- **国内旅行**：基本的な準備タスクセット
- **海外旅行**：パスポート・ビザ確認を含むタスクセット
- **グループ旅行**：分担しやすいタスク構成

#### 5.2 カスタムテンプレート
- よく使うタスクセットを保存
- 他の旅行計画での再利用

## 技術仕様

### データ構造

```typescript
interface PreTravelTask {
  id: string;
  travelId: string;
  title: string;
  category: TaskCategory;
  assignedTo: string[]; // User IDs
  dueDate?: Date;
  priority: 'high' | 'medium' | 'low';
  status: 'pending' | 'completed';
  memo?: string;
  createdBy: string;
  createdAt: Date;
  updatedAt: Date;
  completedAt?: Date;
  completedBy?: string;
}

interface TaskCategory {
  id: string;
  name: string;
  color: string;
  icon: string;
  order: number;
}

interface TaskTemplate {
  id: string;
  name: string;
  description: string;
  type: 'domestic' | 'international' | 'group' | 'custom';
  tasks: Omit<PreTravelTask, 'id' | 'travelId' | 'assignedTo' | 'createdBy' | 'createdAt' | 'updatedAt'>[];
  isPublic: boolean;
  createdBy?: string;
}
```

### UI/UX設計

#### 画面構成
1. **タスク概要画面**：進捗サマリーと期限が近いタスク
2. **タスク一覧画面**：全てのタスクをカテゴリ別に表示
3. **タスク追加画面**：新しいタスクの作成
4. **テンプレート選択画面**：事前定義テンプレートの適用
5. **進捗画面**：メンバー別・カテゴリ別の進捗可視化

#### ナビゲーション
- 旅行詳細画面にタブとして追加
- 「準備」タブでアクセス可能

#### UI/UX実装要件（開発標準）
- **統一モーダルデザイン**：`fixed inset-0 bg-black bg-opacity-50` の共通スタイル
- **z-index管理**：モーダル重なり順序の適切な管理（z-50, z-60等）
- **レスポンシブ対応**：モバイルファーストの画面設計
- **エラーハンドリング**：ユーザーフレンドリーなエラーメッセージ表示
- **リアルタイム更新**：状態変更の即座な反映
- **アクセシビリティ**：キーボード操作・スクリーンリーダー対応

## 実装フェーズ

### Phase 1: 基本機能
- [ ] タスクの作成・編集・削除
- [ ] カテゴリ別分類
- [ ] 担当者指定
- [ ] 完了状態管理
- [ ] 基本的な一覧表示

### Phase 2: 高度な管理機能
- [ ] 期限管理・ソート機能
- [ ] フィルタリング機能
- [ ] 進捗可視化
- [ ] 優先度管理

### Phase 3: テンプレート・通知機能
- [ ] 事前定義テンプレート
- [ ] リマインダー機能
- [ ] カスタムテンプレート
- [ ] 通知システム

## 成功指標

- タスク管理機能の使用率：70%以上
- 旅行前の準備完了率：90%以上
- ユーザーの準備管理満足度向上
- 準備漏れによるトラブル減少

## リスク・考慮事項

- **使いやすさ**：タスク入力の煩雑さを最小限に
- **通知頻度**：過度な通知によるユーザー離れ
- **データ整合性**：メンバー追加・削除時の担当者情報
- **プライバシー**：個人のタスク情報の適切な管理

## 関連ファイル

実装時に関連するファイル：
- `src/types/index.ts` - 型定義の追加
- `src/stores/travelStore.ts` - タスクデータの状態管理
- `src/components/PreTravelTasks.tsx` - メインコンポーネント
- `src/components/TaskTemplates.tsx` - テンプレート機能
- `src/app/travel/[id]/page.tsx` - タブ追加